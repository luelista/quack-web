

<md-toolbar class=" md-accent chat-header">
  <div class="md-toolbar-tools">
    <md-button class="md-icon-button" hide-gt-sm aria-label="Sidebar" ng-click="toggleSideBar()">
      <md-icon>menu</md-icon>
    </md-button>
    <h2>
      <span><strong>{{chat.jid.local}}</strong>@{{chat.jid.domain}}</span><small>{{chat.subject}}</small>
    </h2>
    <span flex></span>
    <md-button class="md-icon-button" aria-label="More" ng-click="rename()">
      <md-icon>edit</md-icon>
    </md-button>
    <md-button class="md-icon-button" aria-label="Favorite" ng-click="goOnline()" ng-hide="chat.online">
      <md-icon>chat_bubble_outline</md-icon>
      <md-tooltip>Join This Conference</md-tooltip>
    </md-button>
    <md-button class="md-icon-button" aria-label="Favorite" ng-click="goOffline()" ng-show="chat.online">
      <md-icon>chat</md-icon>
      <md-tooltip>Leave Conference</md-tooltip>
    </md-button>
    <md-button class="md-icon-button" aria-label="More" ng-click="delete()">
      <md-icon>delete</md-icon>
    </md-button>
  </div>
</md-toolbar>

<div class="occupants" flex=0>
  <span ng-repeat="(nick,occupant) in chat.occupants"
        title="{{occupant.jid.toString()}}"
        ng-class="occupant.chatState">
    {{occupant.nick}}
  </span>
  <!--<md-chips>
    <md-chip ng-repeat="(nick,occupant) in chat.occupants" title="{{occupant.jid}}">
      {{occupant.nick}}
    </md-chip>
  </md-chips>  -->
</div>

<div flex layout="row">
  <md-content scroll-down flex>
    <md-list layout-padding class="messages">
      <md-list-item class="md-3-line" ng-repeat="message in chat.messages" ng-if="$index > skipItemCount">
          <div class="md-avatar" style="background-color: {{message.from.resource|pastel_colour}}" title="{{message.from}}">{{message.from.resource|first_letter}}</div>
          <div class="md-list-item-text" ng-if="message.body">
            <span class="date">{{message.dateTime | date: "HH:mm:ss"}}</span>
            <h3>{{message.from.resource}}</h3>
            <p ng-bind-html="message.body | formatMessage"></p>
          </div>
          <div class="md-list-item-text" ng-if="message.subject">
            <p>*** {{message.from.resource}} set the subject to: <b>{{message.subject}}</b></p>
          </div>

      </md-list-item>
    </md-list>
    <div class="typing-notice" ng-repeat="occupant in chat.occupants" ng-if="occupant.chatState=='composing'">
      {{occupant.nick}} is typing a message...
    </div>
  </md-content>
</div>

<div class="send-message">
    <textarea ng-model="chat.composing" chat-write-message on-send-message="sendMessage()"></textarea>
</div>
